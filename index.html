<!DOCTYPE html>
<html lang="en" ng-app="Museum">
  <head>
    <meta charset="utf-8">
    <title>
      IZI Prototype
    </title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/font-awesome.css" rel="stylesheet">
    <link href="css/jplayer.blue.monday.css" rel="stylesheet">
    <link href="css/toggle-switch.css" rel="stylesheet">
    <link href="css/prototype.css" rel="stylesheet">
    <link href="css/jquery.Jcrop.css" rel="stylesheet">
    <link href="css/jquery.fileupload-ui.css" rel="stylesheet">
  </head>
  <body class="fixed_navbar" drag-and-drop-init="" ng-controller="IndexController" scrollspy-init="">
    <div class="navigation">
      <div class="museum_navigation_menu">
        <div class="museum_navbar row">
          <div class="left_content">
            <i class="icon-plus-sign"></i><a class="top_nav" href="#">New museum</a><i class="icon-plus-sign"></i><a class="top_nav" href="#">New Tour</a>
          </div>
          <div class="navbar-right">
            <museum-search ng-model="museum_search"></museum-search>
            <div class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">{{user.mail}}<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li ng-repeat="provider in user.providers" role="presentation">
                  <a href="{{provider.link}}" role="menuitem" tabindex="-1">{{provider.name}}</a>
                </li>
                <li class="divider"></li>
                <li ng-repeat="provider in user.providers" role="presentation">
                  <a href="{{provider.link}}" role="menuitem" tabindex="-1">Edit {{provider.name}}</a>
                </li>
                <li class="divider"></li>
                <li role="presentation">
                  <a href="" role="menuitem" tabindex="-1">Profile</a>
                </li>
                <li role="presentation">
                  <a href="" role="menuitem" tabindex="-1">Logout</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="museum_filters">
          <a class="time_changed" href="#" ng-class="{&#39;active&#39;: museum_type_filter == &#39;&#39;}" ng-click="museum_type_filter = &#39;&#39;"><i class="icon-time"></i></a><a class="type_museum" href="#" ng-class="{&#39;active&#39;: museum_type_filter == &#39;museum&#39;}" ng-click="museum_type_filter = &#39;museum&#39;"><i class="icon-home"></i></a><a class="type_tour" href="#" ng-class="{&#39;active&#39;: museum_type_filter == &#39;tour&#39;}" ng-click="museum_type_filter = &#39;tour&#39;"><i class="icon-map-marker"></i></a>
        </div>
        <ul class="museum_list row">
          <li class="museum" ng-repeat="museum in museums | filter:museum_search | filter:{type:museum_type_filter}">
            <a href="/{{museum._id}}" ng-class="{&#39;active&#39;: museum.active}"><span class="package_status {{museum.stories.ru.package_status}}"><i ng-class="{&#39;icon-ok-sign&#39;:museum.package_status==&#39;generated&#39;, &#39;icon-refresh&#39;:museum.package_status==&#39;process&#39;}"></i></span><img src="{{museum.images[0].thumbnailUrl || &#39;/img/img-bg.png&#39;}}">
              <h4>
                {{museum.stories.ru.name}}, <span>{{museum.stories.ru.city}}</span>
              </h4>
            </a>
          </li>
        </ul>
      </div>
      <div class="navbar navbar-default" ng-mouseover="show_museum_edit_dropdown=true">
        <div class="left_content">
          <a class="menu_opener" href="#" toggle-menu=""><i class="icon-reorder"></i></a><span class="cms_text_logo">izi.cms</span>
          <h1 class="museum_title" ng-class="{&#39;opened&#39;:museum_edit_dropdown_opened}">
            {{current_museum.stories[current_museum.language].name || current_museum.stories[current_museum.def_lang].name}}
          </h1>
          <div class="btn-group language">
            <button class="btn btn-default dropdown-toggle" data-toggle="dropdown" type="button">{{translations[current_museum.language] || 'New language'}}  <span class="caret"></span></button>
            <ul class="dropdown-menu" role="menu">
              <li ng-repeat="story in current_museum.stories">
                <a href="#" ng-click="current_museum.language = story.language">{{translations[story.language]}}</a>
              </li>
              <li class="divider"></li>
              <li>
                <a href="#" ng-click="new_museum_language()">New language</a>
              </li>
            </ul>
          </div>
        </div>
        <div class="right_content">
          <span class="autosaved_info" ng-show="last_save_time">Changes autosaved at {{ last_save_time | date:'HH:mm'}}</span>
          <div class="hider" ng-hide="museum_edit_dropdown_opened">
            <switchpubitem field="status" ng-item="current_museum.stories[current_museum.language]" ng-museum="current_museum" ng-provider="provider" root="current_museum" translations="translations" type="story"></switchpubitem>
          </div>
        </div>
      </div>
      <div class="museum_edit">
        <div id="museum_edit_dropdown" ng-class="{&#39;invalid&#39;: current_museum.invalid}" ng-controller="MuseumEditController">
          <div can-drag-and-drop="" class="dropdown_area" id="museum_dropzone" model="current_museum" selector="museum_fileupload" selector-dropzone="museum_dropzone" upload-to="{{backend_url}}/upload/{{current_museum._id}}">
            <div class="wrapper">
              <div class="text">
                Drop media files here to attach to this object
              </div>
              <div class="progress">
                <div class="progress-bar progress-bar-success"></div>
              </div>
            </div>
          </div>
          <input class="fileupload" id="museum_fileupload" multiple="" name="files[]" type="file"><lightbox-cropper model="current_museum"></lightbox-cropper>
          <div class="description">
            <div class="controls">
              <a class="delete_story" href="#" ng-click="delete_museum_modal_open()"><i class="icon-trash"></i></a>
              <div class="hider" ng-hide="current_museum.stories[current_museum.language].status == &#39;draft&#39;">
                <switchpubitem field="status" ng-item="current_museum.stories[current_museum.language]" ng-museum="current_museum" ng-provider="provider" root="current_museum" translations="translations" type="story"></switchpubitem>
              </div>
              <div class="close" ng-click="museum_edit_dropdown_close()"></div>
            </div>
            <div class="media_types museum_invalid_media col-xs-2" ng-class="{&#39;invalid&#39;: current_museum.invalid}">
              <i class="icon-picture empty" ng-show="current_museum.images.length == 0"></i><i class="icon-list-ol empty" ng-show="current_museum.number.length == 0"></i><i class="icon-music empty" ng-hide="current_museum.stories[current_museum.language].audio"></i><i class="icon-align-left empty" ng-hide="current_museum.stories[current_museum.language].long_description"></i>
            </div>
            <tabset><tab heading="Main">
                <form class="form-horizontal" name="mainForm" role="form">
                  <placeholderfield ng-field="name" ng-help="help text for popup 2" ng-id="name" ng-item="current_museum.stories[current_museum.language]" ng-title="Name" placeholder="current_museum.stories[current_museum.def_lang].name" type="story"></placeholderfield><audioplayer ng-field="audio" ng-help="help text for popup 5" ng-id="audio" ng-item="current_museum.stories[current_museum.language]" ng-title="Audio" parent="current_museum.stories[current_museum.language]" type="media"></audioplayer><placeholdertextarea maxlength="2000" ng-field="long_description" ng-help="help text for popup 3" ng-id="description" ng-item="current_museum.stories[current_museum.language]" ng-title="Description" placeholder="current_museum.stories[current_museum.def_lang].long_description" type="story"></placeholdertextarea>
                </form>
              </tab><tab heading="Images"><label class="col-xs-1 control-label">Images<span class="label label-danger" ng-show="current_museum.images.length == 0">Fill to publish</span></label>
                <ul class="images col-xs-11">
                  <li ng-repeat="image in current_museum.images">
                    <a class="img_thumbnail" href="#" open-lightbox="{{$index}}"><img alt="" src="{{image.thumbnailUrl || &#39;/img/img-bg.png&#39;}}"></a><a class="remove" data-confirm="Are you sure you wish to delete this image?" data-link="{{$parent.backend_url}}/media/{{media._id}}" data-method="delete" delete-media="" href="#" media="image" parent="$parent.current_museum" rel="nofollow" stop-event="">×</a>
                  </li>
                  <li class="upload_item">
                    <div class="drag_here">
                      <div class="img"></div>
                      <span>Drag images here</span>
                    </div>
                    <div class="or_upload">
                      <span>or</span><a button-file-upload="" class="btn btn-default upload" href="#">Click to upload</a>
                    </div>
                  </li>
                </ul>
              </tab><tab heading="More">
                <ul class="nav nav-stacked nav-list col-xs-2">
                  <li ng-class="{&#39;active&#39;: museum_subtab == &#39;video&#39; }">
                    <a href="#" ng-click="museum_subtab = &#39;video&#39;">Video</a>
                  </li>
                  <li ng-class="{&#39;active&#39;: museum_subtab == &#39;qr-code&#39; }">
                    <a href="#" ng-click="museum_subtab = &#39;qr-code&#39;">QR-code</a>
                  </li>
                  <li ng-class="{&#39;active&#39;: museum_subtab == &#39;quiz&#39; }">
                    <a href="#" ng-click="museum_subtab = &#39;quiz&#39;">Quiz</a>
                  </li>
                  <li ng-class="{&#39;active&#39;: museum_subtab == &#39;collections&#39; }">
                    <a href="#" ng-click="museum_subtab = &#39;collections&#39;">Used in collections</a>
                  </li>
                  <li ng-class="{&#39;active&#39;: museum_subtab == &#39;tours&#39; }">
                    <a href="#" ng-click="museum_subtab = &#39;tours&#39;">Linked in tours</a>
                  </li>
                  <li ng-class="{&#39;active&#39;: museum_subtab == &#39;settings&#39; }">
                    <a href="#" ng-click="museum_subtab = &#39;settings&#39;">Advanced settings</a>
                  </li>
                </ul>
                <div class="tab-content col-xs-10">
                  <div class="tab-pane" ng-class="{&#39;active&#39;: museum_subtab == &#39;video&#39; }">
                    sample video content
                  </div>
                  <div class="tab-pane" ng-class="{&#39;active&#39;: museum_subtab == &#39;qr-code&#39; }">
                    <row>
                      <div class="qr_image col-xs-5">
                        <img alt="Qr_code" src="{{current_museum.stories[current_museum.language].qr_code || &#39;/img/qr_code.png&#39;}}">
                      </div>
                      <div class="well col-xs-5">
                        <a class="btn qr-code" href="{{current_museum.stories[current_museum.language].qr_code}}" target="_blank">Print QR-code</a><br>
                          <p>
                            You can print the Exhibit's QR-code and place it near the Exhibit. When the MTG Client reads this code, it will open the Exhibit's page immediately. If there is no MTG Client installed on the user's phone, then it will take the user to a download page on either AppStore or Google Play.
                          </p>
                        </br>
                      </div>
                    </row>
                  </div>
                  <div class="tab-pane" ng-class="{&#39;active&#39;: museum_subtab == &#39;quiz&#39; }">
                    <div class="row">
                      <form class="form-horizontal" name="museumQuizform" role="form">
                        <div class="switch-toggle ios" quiz-switch="museum_story_quiz" switch-toggle="">
                          <input id="museum_story_quiz_enabled" name="museum_story_quiz_enabled" ng-model="current_museum.stories[current_museum.language].quiz.state" type="radio" value="published"><label for="museum_story_quiz_enabled" ng-click="quiz_state(museumQuizform, current_museum.stories[current_museum.language].quiz)">Enable</label><input id="museum_story_quiz_disabled" name="museum_story_quiz_disabled" ng-model="current_museum.stories[current_museum.language].quiz.state" type="radio" value="limited"><label for="museum_story_quiz_disabled" ng-click="quiz_state(museumQuizform, current_museum.stories[current_museum.language].quiz)">Disable</label><a></a>
                        </div>
                        <placeholderfield ng-field="question" ng-help="help text for popup" ng-id="museum_story_quiz_attributes_question" ng-item="current_museum.stories[current_museum.language].quiz" ng-title="Question" type="quiz"></placeholderfield>
                        <div class="error">
                          <div class="controls"></div>
                        </div>
                        <div class="answers">
                          <quizanswer field="content" ng-collection="current_museum.stories[current_museum.language].quiz.answers" ng-id="story_quiz_attributes_answers_attributes_{{$index}}_content" ng-item="answer" ng-repeat="answer in current_museum.stories[current_museum.language].quiz.answers" type="quiz_answer"></quizanswer>
                        </div>
                        <placeholdertextarea ng-field="comment" ng-help="help text for popup 3" ng-id="quiz_description" ng-item="current_museum.stories[current_museum.language].quiz" ng-title="Description" type="quiz"></placeholdertextarea>
                      </form>
                    </div>
                  </div>
                  <div class="tab-pane" ng-class="{&#39;active&#39;: museum_subtab == &#39;collections&#39; }">
                    2222
                  </div>
                  <div class="tab-pane" ng-class="{&#39;active&#39;: museum_subtab == &#39;tours&#39; }">
                    33333
                  </div>
                  <div class="tab-pane" ng-class="{&#39;active&#39;: museum_subtab == &#39;settings&#39; }">
                    44444
                  </div>
                </div>
              </tab></tabset>
          </div>
        </div>
      </div>
      <div class="museum_edit_opener" ng-click="show_museum_edit($event)" ng-show="show_museum_edit_dropdown || museum_edit_dropdown_opened">
        Museum properties  <i class="icon-chevron-down"></i>
      </div>
    </div>
    <div class="float_menu">
      <div class="actions_bar">
        <error-notification></error-notification>
        <div class="left_content" ng-mouseover="show_museum_edit_dropdown=false">
          <button class="btn btn-warning spacer" id="create_new_item" ng-class="{&#39;disabled&#39;:new_item_creation}" ng-click="create_new_item()" type="button">New item </button>
          <div class="btn-group spacer lang_switch">
            <button class="btn btn-default dropdown-toggle" data-toggle="dropdown" type="button">{{translations[current_museum.language] || 'New language'}}  <span class="caret"></span></button>
            <ul class="dropdown-menu" role="menu">
              <li ng-repeat="story in current_museum.stories">
                <a href="#" ng-click="current_museum.language = story.language">{{translations[story.language]}}</a>
              </li>
              <li class="divider"></li>
              <li>
                <a href="#" ng-click="new_museum_language()">New language</a>
              </li>
            </ul>
          </div>
          <div class="btn-group">
            <button class="btn btn-default dropdown-toggle spacer" data-toggle="dropdown" type="button">Actions  <span class="caret"></span></button>
            <ul class="dropdown-menu" role="menu">
              <li ng-click="select_all_exhibits()" ng-switch="" on="all_selected">
                <a href="#" ng-switch-when="false">Select all</a><a href="#" ng-switch-when="true">Cancel selection</a>
              </li>
              <li class="dropdown-submenu">
                <a href="#">Add selected items to collection...</a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="#">Collection 1</a>
                  </li>
                  <li>
                    <a href="#">Collection 2</a>
                  </li>
                  <li>
                    <a href="#">Collection 3</a>
                  </li>
                </ul>
              </li>
              <li class="dropdown-submenu">
                <a href="#">Set visibility selected items...</a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="#" ng-click="mass_switch_pub(&#39;published&#39;)"><i class="icon-globe"></i>  Everyone</a>
                  </li>
                  <li>
                    <a href="#" ng-click="mass_switch_pub(&#39;passcode&#39;)"><i class="icon-lock"></i>  Only users who have passcode</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="#" ng-click="delete_selected_exhibits()">Delete selected items</a>
              </li>
            </ul>
          </div>
          <a class="spacer" href="#" ng-click="select_all_exhibits(&#39;select&#39;)" ng-show="select_all_enabled"><span>Select all</span></a><a class="spacer" href="#" ng-click="select_all_exhibits(&#39;cancel&#39;)" ng-show="select_all_enabled"><span>Cancel selection</span></a>
        </div>
        <div class="right_content" ng-mouseover="show_museum_edit_dropdown=false">
          <input class="form-control search spacer" ng-model="exhibit_search" placeholder="Search" resizer="" type="text"><button class="btn btn-default filter_opener" ng-class="{&#39;active&#39;: filters_opened}" toggle-filters="" type="button">Filters and sort</button>
        </div>
      </div>
      <div class="filters_bar">
        <div class="dropdown spacer">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="sort_order">{{sort_text}} <span class="caret"></span></a>
          <ul aria-labelledby="visibility_filter" class="dropdown-menu" role="menu">
            <li role="presentation">
              <a href="#" ng-click="sort_text=&#39;Sort 0-9&#39;; reload_exhibits(&#39;number&#39;, 1)">Sort 0-9</a>
            </li>
            <li role="presentation">
              <a href="#" ng-click="sort_text=&#39;Sort 9-0&#39;; reload_exhibits(&#39;number&#39;, -1)"> Sort 9-0</a>
            </li>
          </ul>
        </div>
        <div class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Visibility in mobile application <span class="caret"></span></a>
          <ul aria-labelledby="visibility_filter" class="dropdown-menu" role="menu">
            <li role="presentation">
              <a role="menuitem">Everyone</a>
            </li>
            <li role="presentation">
              <a role="menuitem"> Only users who have passcode</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="page-wrapper" ng-mouseover="show_museum_edit_dropdown=false">
      <div class="page-preloader"></div>
      <div class="page">
        <script id="myDummyModalContent.html" type="text/ng-template">
          <div class="modal-dialog" id="dummyModal">
            <div class="modal-content">
              <div class="modal-body">
                <h4 class="modal-title">
                  Name of exhibit is empty
                </h4>
              </div>
              <div class="modal-footer">
                <button class="btn btn-default" ng-click="discard()" type="button">Discard item</button><button class="btn btn-default" ng-click="save_as()" type="button">Save as "item_{{exhibit.number}}"</button>
              </div>
            </div>
          </div>
        </script>
        <script id="myMuseumModalContent.html" type="text/ng-template">
          <div class="modal-dialog" id="new_museum">
            <div class="modal-content">
              <div class="modal-header">
                <h3 class="modal-title">
                  New language
                </h3>
              </div>
              <div class="modal-body description">
                <form class="form-horizontal">
                  <new-lang-switch museum="museum"></new-lang-switch><placeholderfield ng-field="name" ng-help="help text for popup 2" ng-id="name" ng-item="museum.stories.dummy" ng-title="Name" placeholder="museum.stories.dummy.name" type="story"></placeholderfield>
                </form>
              </div>
              <div class="modal-footer">
                <button class="btn btn-warning" ng-class="{&#39;disabled&#39;: museum.stories.dummy.name.length == 0 &amp;&amp; museum.language != &#39;new_lang&#39; }" ng-click="save_as()" type="button">Create</button><button class="btn btn-default" ng-click="discard()" type="button">Cancel</button>
              </div>
            </div>
          </div>
        </script>
        <script id="myModalContent.html" type="text/ng-template">
          <div class="modal-dialog" id="delete_story">
            <div class="modal-content">
              <div class="modal-body">
                <form class="form-horizontal">
                  <div class="only_one" ng-show="only_one">
                    <div class="form-group">
                      <label class="control-label" for="lang_def_{{modal_options.current_language.language}}" ng-click="show_langs = false; mark_default_only()"><input checked="checked" class="hidden" id="lang_def_{{modal_options.current_language.language}}" name="language" type="radio" value="en">Delete item completely?</label>
                    </div>
                  </div>
                  <div class="multiply" ng-hide="only_one">
                    <div class="form-group">
                      <label class="control-label" for="lang_{{modal_options.current_language.language}}" ng-click="show_langs = false; mark_default_only()"><input checked="checked" id="lang_{{modal_options.current_language.language}}" name="language" type="radio" value="en">Delete only {{modal_options.current_language.name}} language</label>
                    </div>
                    <div class="form-group">
                      <label class="control-label" for="lang_all" ng-click="show_langs = false; mark_all()"><input id="lang_all" name="language" type="radio" value="all">Delete all languages</label>
                    </div>
                    <div class="form-group">
                      <label class="control-label lang_selected" for="lang_selected" ng-click="show_langs = true"><input id="lang_selected" name="language" type="radio" value="selected">Delete only selected languages</label>
                    </div>
                  </div>
                  <div class="other_variants" ng-show="show_langs">
                    <div class="form-group" ng-repeat=" (language, value) in modal_options.languages">
                      <label class="control-label" for="language_{{value.name}}"><input id="language_{{value.name}}" name="languages[]" ng-change="lang_proc()" ng-checked="value.checked" ng-model="value.checked" type="checkbox" value="{{language}}">{{value.name}}</label>
                    </div>
                  </div>
                  <div class="password" ng-show="password_input_shown">
                    <label class="control-label" for="modal_delete_password">Please, enter your password to confirm deletion</label><input id="modal_delete_password" name="modal_delete_password" ng-change="console.log(&#39;11111111111&#39;)" ng-model="$parent.deletion_password" type="password">
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button class="btn btn-default" ng-click="ok()" type="button">Delete</button><button class="btn btn-default" ng-click="cancel()" type="button">Cancel</button>
              </div>
            </div>
          </div>
        </script>
        <script id="museumDelete.html" type="text/ng-template">
          <div class="modal-dialog" id="delete_museum_story">
            <div class="modal-content">
              <div class="modal-body">
                <form class="form-horizontal">
                  <div class="multiply" ng-hide="only_one">
                    <div class="form-group">
                      <label class="control-label" for="only_default"><input id="only_default" name="variant" ng-checked="variant.checked" ng-model="variant.checked" type="radio" value="lang">Delete museum in {{modal_options.current_language.name}} language (including exhibits an collections)</label>
                    </div>
                    <div class="form-group">
                      <label class="control-label" for="museum_lang_all"><input id="museum_lang_all" name="variant" ng-checked="variant.checked" ng-model="variant.checked" type="radio" value="all">Delete whole museum  (including exhibits an collections)</label>
                    </div>
                  </div>
                  <div class="password">
                    <label class="control-label" for="modal_delete_password">Please, enter your password to confirm deletion</label><input id="modal_delete_password" name="modal_delete_password" ng-model="$parent.deletion_password" type="password">
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button class="btn btn-default" ng-click="ok()" type="button">Delete</button><button class="btn btn-default" ng-click="cancel()" type="button">Cancel</button>
              </div>
            </div>
          </div>
        </script>
        <ul class="exhibits">
          <li drop-down-edit="" id="drop_down" ng-class="{&#39;invalid&#39;: active_exhibit.invalid}">
            <div can-drag-and-drop="" class="dropdown_area" id="dropzone" model="active_exhibit" selector="fileupload" selector-dropzone="dropzone" upload-to="{{backend_url}}/upload/{{active_exhibit._id}}">
              <div class="wrapper">
                <div class="text">
                  Drop media files here to attach to this object
                </div>
                <div class="progress" id="progress">
                  <div class="progress-text">
                    Загружено ... из ..., скорость: 256kb/s
                  </div>
                  <div class="progress-bar progress-bar-success"></div>
                </div>
              </div>
            </div>
            <input class="fileupload" id="fileupload" multiple="" name="files[]" type="file"><lightbox-cropper model="active_exhibit"></lightbox-cropper>
            <div class="description">
              <div class="controls">
                <a class="delete_story" href="#" ng-click="delete_modal_open()"><i class="icon-trash"></i></a>
                <div class="hider" ng-hide="active_exhibit.stories[current_museum.language].status == &#39;draft&#39;">
                  <switchpubitem field="status" ng-item="active_exhibit.stories[current_museum.language]" ng-museum="current_museum" ng-provider="provider" root="active_exhibit" translations="translations" type="story"></switchpubitem>
                </div>
                <div class="close"></div>
              </div>
              <tabset><tab active="dropdown.new_item_creation" heading="Main">
                  <form class="form-horizontal" name="mainForm" role="form">
                    <placeholderfield ng-field="name" ng-help="help text for popup 2" ng-id="name" ng-item="active_exhibit.stories[current_museum.language]" ng-title="Name" placeholder="active_exhibit.stories[current_museum.def_lang].name" type="story"></placeholderfield><audioplayer ng-field="audio" ng-help="help text for popup 5" ng-id="audio" ng-item="active_exhibit.stories[current_museum.language]" ng-title="Audio" parent="active_exhibit.stories[current_museum.language]" type="media"></audioplayer><placeholdertextarea maxlength="2000" ng-field="long_description" ng-help="help text for popup 3" ng-id="description" ng-item="active_exhibit.stories[current_museum.language]" ng-title="Description" placeholder="active_exhibit.stories[current_museum.def_lang].long_description" type="story"></placeholdertextarea>
                  </form>
                </tab><tab heading="Images"><label class="col-xs-1 control-label">Images<span class="label label-danger" ng-show="active_exhibit.images.length == 0">Fill to publish</span></label>
                  <ul class="images col-xs-11">
                    <li ng-repeat="image in active_exhibit.images">
                      <a class="img_thumbnail" href="#" open-lightbox="{{$index}}"><img alt="" src="{{image.thumbnailUrl || &#39;/img/img-bg.png&#39;}}"></a><a class="remove" data-confirm="Are you sure you wish to delete this image?" data-link="{{$parent.backend_url}}/media/{{media._id}}" data-method="delete" delete-media="" href="#" media="image" parent="$parent.active_exhibit" rel="nofollow" stop-event="">×</a>
                    </li>
                    <li class="upload_item">
                      <div class="drag_here">
                        <div class="img"></div>
                        <span>Drag images here</span>
                      </div>
                      <div class="or_upload">
                        <span>or</span><a button-file-upload="" class="btn btn-default upload" href="#">Click to upload</a>
                      </div>
                    </li>
                  </ul>
                </tab><tab heading="More">
                  <ul class="nav nav-stacked nav-list col-xs-2">
                    <li ng-class="{&#39;active&#39;: story_subtab == &#39;video&#39; }">
                      <a href="#" ng-click="story_subtab = &#39;video&#39;">Video</a>
                    </li>
                    <li ng-class="{&#39;active&#39;: story_subtab == &#39;qr-code&#39; }">
                      <a href="#" ng-click="story_subtab = &#39;qr-code&#39;">QR-code</a>
                    </li>
                    <li ng-class="{&#39;active&#39;: story_subtab == &#39;quiz&#39; }">
                      <a href="#" ng-click="story_subtab = &#39;quiz&#39;">Quiz</a>
                    </li>
                    <li ng-class="{&#39;active&#39;: story_subtab == &#39;collections&#39; }">
                      <a href="#" ng-click="story_subtab = &#39;collections&#39;">Used in collections</a>
                    </li>
                    <li ng-class="{&#39;active&#39;: story_subtab == &#39;tours&#39; }">
                      <a href="#" ng-click="story_subtab = &#39;tours&#39;">Linked in tours</a>
                    </li>
                    <li ng-class="{&#39;active&#39;: story_subtab == &#39;settings&#39; }">
                      <a href="#" ng-click="story_subtab = &#39;settings&#39;">Advanced settings</a>
                    </li>
                  </ul>
                  <div class="tab-content col-xs-10">
                    <div class="tab-pane" ng-class="{&#39;active&#39;: story_subtab == &#39;video&#39; }">
                      sample video content
                    </div>
                    <div class="tab-pane" ng-class="{&#39;active&#39;: story_subtab == &#39;qr-code&#39; }">
                      <row>
                        <div class="qr_image col-xs-5">
                          <img alt="Qr_code" src="{{active_exhibit.stories[current_museum.language].qr_code || &#39;/img/qr_code.png&#39;}}">
                        </div>
                        <div class="well col-xs-5">
                          <a class="btn qr-code" href="{{active_exhibit.stories[current_museum.language].qr_code}}" target="_blank">Print QR-code</a><br>
                            <p>
                              You can print the Exhibit's QR-code and place it near the Exhibit. When the MTG Client reads this code, it will open the Exhibit's page immediately. If there is no MTG Client installed on the user's phone, then it will take the user to a download page on either AppStore or Google Play.
                            </p>
                          </br>
                        </div>
                      </row>
                    </div>
                    <div class="tab-pane" ng-class="{&#39;active&#39;: story_subtab == &#39;quiz&#39; }">
                      <div class="row">
                        <form class="form-horizontal" name="quizform" role="form">
                          <div class="switch-toggle ios" quiz-switch="story_quiz" switch-toggle="">
                            <input id="story_quiz_enabled" name="story_quiz_enabled" ng-model="active_exhibit.stories[current_museum.language].quiz.status" type="radio" value="published"><label for="story_quiz_enabled" ng-click="quiz_state(quizform, active_exhibit.stories[current_museum.language].quiz)">Enable</label><input id="story_quiz_disabled" name="story_quiz_enabled" ng-model="active_exhibit.stories[current_museum.language].quiz.status" type="radio" value="limited"><label for="story_quiz_disabled" ng-click="quiz_state(quizform, active_exhibit.stories[current_museum.language].quiz)">Disable</label><a></a>
                          </div>
                          <placeholderfield ng-field="question" ng-help="help text for popup" ng-id="story_quiz_attributes_question" ng-item="active_exhibit.stories[current_museum.language].quiz" ng-title="Question" type="quiz"></placeholderfield>
                          <div class="error">
                            <div class="controls"></div>
                          </div>
                          <div class="answers">
                            <quizanswer field="content" ng-collection="active_exhibit.stories[current_museum.language].quiz.answers" ng-id="story_quiz_attributes_answers_attributes_{{$index}}_content" ng-item="answer" ng-repeat="answer in active_exhibit.stories[current_museum.language].quiz.answers" type="quiz_answer"></quizanswer>
                          </div>
                          <placeholdertextarea ng-field="comment" ng-help="help text for popup 3" ng-id="quiz_description" ng-item="active_exhibit.stories[current_museum.language].quiz" ng-title="Description" type="quiz"></placeholdertextarea>
                        </form>
                      </div>
                    </div>
                    <div class="tab-pane" ng-class="{&#39;active&#39;: story_subtab == &#39;collections&#39; }">
                      2222
                    </div>
                    <div class="tab-pane" ng-class="{&#39;active&#39;: story_subtab == &#39;tours&#39; }">
                      33333
                    </div>
                    <div class="tab-pane" ng-class="{&#39;active&#39;: story_subtab == &#39;settings&#39; }">
                      <form class="form-horizontal" role="form">
                        <placeholderfield ng-field="number" ng-help="help text for popup" ng-id="opas_number" ng-item="active_exhibit" ng-title="OPAS №" placeholder="active_exhibit.number" type="story_set"></placeholderfield>
                      </form>
                    </div>
                  </div>
                </tab></tabset>
            </div>
          </li>
          <li class="exhibit" ng-class="{active: exhibit.active}" ng-hide="ajax_progress" ng-repeat="exhibit in exhibits | filter:criteriaMatch(exhibit_search)" post-render="">
            <div class="opener {{exhibit.stories[current_museum.language].status}}" ng-class="{&#39;border&#39;: exhibit.selected, &#39;draft&#39;:exhibit.stories[current_museum.language].name.length == 0}">
              <div class="checkbox">
                <input ng-change="check_selected()" ng-model="exhibit.selected" type="checkbox">
              </div>
              <div class="image">
                <img ng-click="open_dropdown($event, exhibit)" src="{{exhibit.images[0].thumbnailUrl || &#39;/img/img-bg.png&#39;}}">
              </div>
              <div class="description" ng-click="open_dropdown($event, exhibit)">
                <h4 ng-class="{&#39;dummy_header&#39;:exhibit.stories[current_museum.language].name.length == 0}">
                  {{exhibit.number}} {{exhibit.stories[current_museum.language].name || exhibit.stories[current_museum.def_lang].name}}
                </h4>
                <div class="media_types" ng-class="{&#39;invalid&#39;: exhibit.invalid}">
                  <i class="icon-picture empty" ng-show="exhibit.images.length == 0"></i><i class="icon-list-ol empty" ng-show="exhibit.number.length == 0"></i><i class="icon-music" ng-show="exhibit.stories[current_museum.language].audio"></i><i class="icon-music empty" ng-hide="exhibit.stories[current_museum.language].audio"></i><i class="icon-align-left" ng-show="exhibit.stories[current_museum.language].long_description"></i><i class="icon-align-left empty" ng-hide="exhibit.stories[current_museum.language].long_description"></i><i class="icon-youtube-play" ng-show="exhibit.stories[current_museum.language].video"></i><i class="icon-puzzle-piece" ng-show="exhibit.stories[current_museum.language].quiz.status == &#39;published&#39;"></i>
                </div>
              </div>
              <div class="visibility" ng-class="{&#39;invalid&#39;: exhibit.invalid}" ng-switch="" on="exhibit.stories[current_museum.language].status">
                <i class="icon-globe placeholder" ng-switch-when="published"></i><i class="icon-lock placeholder" ng-switch-when="passcode"></i>
                <div class="on_hover">
                  <switchpub field="status" ng-item="exhibit.stories[current_museum.language]" ng-provider="provider" root="exhibit" type="story"></switchpub>
                </div>
              </div>
            </div>
          </li>
          <li class="exhibit dummy" data-big-image="/img/img-bg.png" ng-show="new_item_creation">
            <div class="opener draft">
              <div class="overlay" ng-click="open_dropdown($event, new_exhibit)"></div>
              <div class="image">
                <img src="/img/img-bg.png">
              </div>
              <div class="description" ng-click="open_dropdown($event, new_exhibit)">
                <h4>
                  {{new_exhibit.number || '' }} {{new_exhibit.stories[current_museum.language].name || '' }}
                </h4>
              </div>
            </div>
          </li>
          <li ng-repeat="story in stories">
            {{story}}
          </li>
        </ul>
      </div>
    </div>
    <to-top></to-top>
    <script src="lib/angular/angular.min.js"></script>
    <script src="lib/angular/angular-cookies.js"></script>
    <script src="lib/ui-bootstrap-tpls-0.6.0.js"></script>
    <script src="lib/ui-bootstrap-0.6.0.js"></script>
    <script src="lib/angularLocalStorage.js"></script>
    <script src="lib/jquery-1.10.2.js"></script>
    <script src="lib/jquery.scrollTo.js"></script>
    <script src="lib/jquery.jplayer.min.js"></script>
    <script src="lib/jQuery-File-Upload/vendor/jquery.ui.widget.js"></script>
    <script src="lib/jQuery-File-Upload/jquery.iframe-transport.js"></script>
    <script src="lib/jQuery-File-Upload/jquery.fileupload.js"></script>
    <script src="lib/jQuery-File-Upload/jquery.fileupload-angular.js"></script>
    <script src="lib/jQuery-File-Upload/jquery.fileupload-fp.js"></script>
    <script src="lib/jQuery-File-Upload/locale.js"></script>
    <script src="lib/jquery-ui.js"></script>
    <script src="lib/async.js"></script>
    <script src="lib/ngProgress.js"></script>
    <script src="lib/jquery.Jcrop.min.js"></script>
    <script src="lib/jquery.color.js"></script>
    <script src="lib/jquery-scrollspy.js"></script>
    <script src="js/app.js"></script>
    <script src="js/services.js"></script>
    <script src="js/controllers.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/directives.js"></script>
  </body>
</html>
